(()=>{function ce(e){return e.replace(/(?:[_-])([a-z0-9])/g,(t,s)=>s.toUpperCase())}function Ie(e){return ce(e.replace(/--/g,"-").replace(/__/g,"_"))}function H(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Pe(e){return e.replace(/([A-Z])/g,(t,s)=>`-${s.toLowerCase()}`)}function te(e){return e!=null}function se(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _(e,t){let s=he(e);return Array.from(s.reduce((r,n)=>(Ne(n,t).forEach(c=>r.add(c)),r),new Set))}function De(e,t){return he(e).reduce((r,n)=>(r.push(...Be(n,t)),r),[])}function he(e){let t=[];for(;e;)t.push(e),e=Object.getPrototypeOf(e);return t.reverse()}function Ne(e,t){let s=e[t];return Array.isArray(s)?s:[]}function Be(e,t){let s=e[t];return s?Object.keys(s).map(r=>[r,s[r]]):[]}var Pt=(()=>{function e(s){function r(){return Reflect.construct(s,arguments,new.target)}return r.prototype=Object.create(s.prototype,{constructor:{value:r}}),Reflect.setPrototypeOf(r,s),r}function t(){let r=e(function(){this.a.call(this)});return r.prototype.a=function(){},new r}try{return t(),e}catch{return r=>class extends r{}}})();var Nt={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:e=>`data-${e}-target`,outletAttributeForScope:(e,t)=>`data-${e}-${t}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},re("abcdefghijklmnopqrstuvwxyz".split("").map(e=>[e,e]))),re("0123456789".split("").map(e=>[e,e])))};function re(e){return e.reduce((t,[s,r])=>Object.assign(Object.assign({},t),{[s]:r}),{})}function $e(e){return _(e,"classes").reduce((s,r)=>Object.assign(s,Ve(r)),{})}function Ve(e){return{[`${e}Class`]:{get(){let{classes:t}=this;if(t.has(e))return t.get(e);{let s=t.getAttributeName(e);throw new Error(`Missing attribute "${s}"`)}}},[`${e}Classes`]:{get(){return this.classes.getAll(e)}},[`has${H(e)}Class`]:{get(){return this.classes.has(e)}}}}function Re(e){return _(e,"outlets").reduce((s,r)=>Object.assign(s,xe(r)),{})}function ne(e,t,s){return e.application.getControllerForElementAndIdentifier(t,s)}function ie(e,t,s){let r=ne(e,t,s);if(r||(e.application.router.proposeToConnectScopeForElementAndIdentifier(t,s),r=ne(e,t,s),r))return r}function xe(e){let t=Ie(e);return{[`${t}Outlet`]:{get(){let s=this.outlets.find(e),r=this.outlets.getSelectorForOutletName(e);if(s){let n=ie(this,s,e);if(n)return n;throw new Error(`The provided outlet element is missing an outlet controller "${e}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${e}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${r}".`)}},[`${t}Outlets`]:{get(){let s=this.outlets.findAll(e);return s.length>0?s.map(r=>{let n=ie(this,r,e);if(n)return n;console.warn(`The provided outlet element is missing an outlet controller "${e}" instance for host controller "${this.identifier}"`,r)}).filter(r=>r):[]}},[`${t}OutletElement`]:{get(){let s=this.outlets.find(e),r=this.outlets.getSelectorForOutletName(e);if(s)return s;throw new Error(`Missing outlet element "${e}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${r}".`)}},[`${t}OutletElements`]:{get(){return this.outlets.findAll(e)}},[`has${H(t)}Outlet`]:{get(){return this.outlets.has(e)}}}}function je(e){return _(e,"targets").reduce((s,r)=>Object.assign(s,Ue(r)),{})}function Ue(e){return{[`${e}Target`]:{get(){let t=this.targets.find(e);if(t)return t;throw new Error(`Missing target element "${e}" for "${this.identifier}" controller`)}},[`${e}Targets`]:{get(){return this.targets.findAll(e)}},[`has${H(e)}Target`]:{get(){return this.targets.has(e)}}}}function He(e){let t=De(e,"values"),s={valueDescriptorMap:{get(){return t.reduce((r,n)=>{let c=ue(n,this.identifier),d=this.data.getAttributeNameForKey(c.key);return Object.assign(r,{[d]:c})},{})}}};return t.reduce((r,n)=>Object.assign(r,qe(n)),s)}function qe(e,t){let s=ue(e,t),{key:r,name:n,reader:c,writer:d}=s;return{[n]:{get(){let g=this.data.get(r);return g!==null?c(g):s.defaultValue},set(g){g===void 0?this.data.delete(r):this.data.set(r,d(g))}},[`has${H(n)}`]:{get(){return this.data.has(r)||s.hasCustomDefaultValue}}}}function ue([e,t],s){return We({controller:s,token:e,typeDefinition:t})}function U(e){switch(e){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function $(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(e))return"array";if(Object.prototype.toString.call(e)==="[object Object]")return"object"}function Ke(e){let{controller:t,token:s,typeObject:r}=e,n=te(r.type),c=te(r.default),d=n&&c,g=n&&!c,l=!n&&c,h=U(r.type),u=$(e.typeObject.default);if(g)return h;if(l)return u;if(h!==u){let b=t?`${t}.${s}`:s;throw new Error(`The specified default value for the Stimulus Value "${b}" must match the defined type "${h}". The provided default value of "${r.default}" is of type "${u}".`)}if(d)return h}function _e(e){let{controller:t,token:s,typeDefinition:r}=e,c=Ke({controller:t,token:s,typeObject:r}),d=$(r),g=U(r),l=c||d||g;if(l)return l;let h=t?`${t}.${r}`:s;throw new Error(`Unknown value type "${h}" for "${s}" value`)}function ze(e){let t=U(e);if(t)return oe[t];let s=se(e,"default"),r=se(e,"type"),n=e;if(s)return n.default;if(r){let{type:c}=n,d=U(c);if(d)return oe[d]}return e}function We(e){let{token:t,typeDefinition:s}=e,r=`${Pe(t)}-value`,n=_e(e);return{type:n,key:r,name:ce(r),get defaultValue(){return ze(s)},get hasCustomDefaultValue(){return $(s)!==void 0},reader:Je[n],writer:ae[n]||ae.default}}var oe={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},Je={array(e){let t=JSON.parse(e);if(!Array.isArray(t))throw new TypeError(`expected value of type "array" but instead got value "${e}" of type "${$(t)}"`);return t},boolean(e){return!(e=="0"||String(e).toLowerCase()=="false")},number(e){return Number(e.replace(/_/g,""))},object(e){let t=JSON.parse(e);if(t===null||typeof t!="object"||Array.isArray(t))throw new TypeError(`expected value of type "object" but instead got value "${e}" of type "${$(t)}"`);return t},string(e){return e}},ae={default:Xe,array:le,object:le};function le(e){return JSON.stringify(e)}function Xe(e){return`${e}`}var k=class{constructor(t){this.context=t}static get shouldLoad(){return!0}static afterLoad(t,s){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(t,{target:s=this.element,detail:r={},prefix:n=this.identifier,bubbles:c=!0,cancelable:d=!0}={}){let g=n?`${n}:${t}`:t,l=new CustomEvent(g,{detail:r,bubbles:c,cancelable:d});return s.dispatchEvent(l),l}};k.blessings=[$e,je,He,Re];k.targets=[];k.outlets=[];k.values={};var Ge=class{constructor(e,t,s){this.isResolved=!1,this.promise=e,this.promise.then(r=>(this.isResolved=!0,r)),this.actions=t,this.updatedModels=s}containsOneOfActions(e){return this.actions.filter(t=>e.includes(t)).length>0}areAnyModelsUpdated(e){return this.updatedModels.filter(t=>e.includes(t)).length>0}},Ye=class{constructor(e,t="post"){this.url=e,this.method=t}buildRequest(e,t,s,r,n,c){let d=this.url.split("?"),[g]=d,[,l]=d,h=new URLSearchParams(l||""),u={};u.headers={Accept:"application/vnd.live-component+html","X-Requested-With":"XMLHttpRequest","X-Live-Url":window.location.pathname+window.location.search};let b=Object.entries(c).reduce((O,C)=>O+C.length,0),A=Object.keys(r).length>0;if(t.length===0&&b===0&&this.method==="get"&&this.willDataFitInUrl(JSON.stringify(e),JSON.stringify(s),h,JSON.stringify(r),JSON.stringify(n)))h.set("props",JSON.stringify(e)),h.set("updated",JSON.stringify(s)),Object.keys(n).length>0&&h.set("propsFromParent",JSON.stringify(n)),A&&h.set("children",JSON.stringify(r)),u.method="GET";else{u.method="POST";let O={props:e,updated:s};Object.keys(n).length>0&&(O.propsFromParent=n),A&&(O.children=r),t.length>0&&(t.length===1?(O.args=t[0].args,g+=`/${encodeURIComponent(t[0].name)}`):(g+="/_batch",O.actions=t));let C=new FormData;C.append("data",JSON.stringify(O));for(let[x,T]of Object.entries(c)){let j=T.length;for(let D=0;D<j;++D)C.append(x,T[D])}u.body=C}let w=h.toString();return{url:`${g}${w.length>0?`?${w}`:""}`,fetchOptions:u}}willDataFitInUrl(e,t,s,r,n){return(new URLSearchParams(e+t+r+n).toString()+s.toString()).length<1500}},Ze=class{constructor(e,t="post"){this.requestBuilder=new Ye(e,t)}makeRequest(e,t,s,r,n,c){let{url:d,fetchOptions:g}=this.requestBuilder.buildRequest(e,t,s,r,n,c);return new Ge(fetch(d,g),t.map(l=>l.name),Object.keys(s))}},Qe=class{constructor(e){this.response=e}async getBody(){return this.body||(this.body=await this.response.text()),this.body}getLiveUrl(){return this.liveUrl===void 0&&(this.liveUrl=this.response.headers.get("X-Live-Url")),this.liveUrl}};function q(e){return e.innerHTML?e.outerHTML.slice(0,e.outerHTML.indexOf(e.innerHTML)):e.outerHTML}var X=new WeakMap,V=new Map,et=e=>{X.set(e.element,e),V.set(e,e.name)},tt=e=>{X.delete(e.element),V.delete(e)};var st=(e,t,s)=>{let r=[];return V.forEach((n,c)=>{t&&(e===c||!c.element.contains(e.element))||s&&n!==s||r.push(c)}),r},rt=e=>{let t=[];return V.forEach((s,r)=>{if(e===r||!e.element.contains(r.element))return;let n=!1;V.forEach((c,d)=>{n||d!==r&&d.element.contains(r.element)&&(n=!0)}),t.push(r)}),t},nt=e=>{let t=e.element.parentElement;for(;t;){let s=X.get(t);if(s)return s;t=t.parentElement}return null};function L(e){let t=[];if(!e)return t;let s="",r="",n=[],c=[],d="action",g=()=>{if(s)return s;if(t.length===0)throw new Error("Could not find any directives");return t[t.length-1].action},l=()=>{t.push({action:s,args:n,modifiers:c,getString:()=>e}),s="",r="",n=[],c=[],d="action"},h=()=>{n.push(r.trim()),r=""},u=()=>{if(n.length>1)throw new Error(`The modifier "${s}()" does not support multiple arguments.`);c.push({name:s,value:n.length>0?n[0]:null}),s="",n=[],d="action"};for(let b=0;b<e.length;b++){let A=e[b];switch(d){case"action":if(A==="("){d="arguments";break}if(A===" "){s&&l();break}if(A==="|"){u();break}s+=A;break;case"arguments":if(A===")"){h(),d="after_arguments";break}if(A===","){h();break}r+=A;break;case"after_arguments":if(A==="|"){u();break}if(A!==" ")throw new Error(`Missing space after ${g()}()`);l();break}}switch(d){case"action":case"after_arguments":s&&l();break;default:throw new Error(`Did you forget to add a closing ")" after "${s}"?`)}return t}function de(e){let t=[];return e.forEach(s=>{t.push(...it(s).split(" "))}),t}function it(e){return e.replace(/[\s]+/g," ").trim()}function I(e){return e.replace(/\[]$/,"").split("[").map(t=>t.replace("]","")).join(".")}function G(e,t){if(e instanceof HTMLInputElement){if(e.type==="checkbox"){let s=P(e,!1);if(s!==null){let r=t.get(s.action);if(Array.isArray(r))return fe(e,r);if(Object(r)===r)return fe(e,Object.values(r))}return e.hasAttribute("value")?e.checked?e.getAttribute("value"):null:e.checked}return ve(e)}return e instanceof HTMLSelectElement?e.multiple?Array.from(e.selectedOptions).map(s=>s.value):e.value:e.hasAttribute("data-value")?e.dataset.value:"value"in e?e.value:e.hasAttribute("value")?e.getAttribute("value"):null}function W(e,t){if(e instanceof HTMLInputElement){if(e.type==="file")return;if(e.type==="radio"){e.checked=e.value==t;return}if(e.type==="checkbox"){Array.isArray(t)?e.checked=t.some(s=>s==e.value):e.hasAttribute("value")?e.checked=e.value==t:e.checked=t;return}}if(e instanceof HTMLSelectElement){let s=[].concat(t).map(r=>`${r}`);Array.from(e.options).forEach(r=>{r.selected=s.includes(r.value)});return}t=t===void 0?"":t,e.value=t}function me(e){if(!e.dataset.model)return[];let t=L(e.dataset.model);return t.forEach(s=>{if(s.args.length>0)throw new Error(`The data-model="${e.dataset.model}" format is invalid: it does not support passing arguments to the model.`);s.action=I(s.action)}),t}function P(e,t=!0){let s=me(e);if(s.length>0)return s[0];if(e.getAttribute("name")){let r=e.closest("form");if(r&&"model"in r.dataset){let c=L(r.dataset.model||"*")[0];if(c.args.length>0)throw new Error(`The data-model="${r.dataset.model}" format is invalid: it does not support passing arguments to the model.`);return c.action=I(e.getAttribute("name")),c}}if(!t)return null;throw new Error(`Cannot determine the model name for "${q(e)}": the element must either have a "data-model" (or "name" attribute living inside a <form data-model="*">).`)}function R(e,t){return t.element===e?!0:t.element.contains(e)?e.closest('[data-controller~="live"]')===t.element:!1}function z(e){let t=e.cloneNode(!0);if(!(t instanceof HTMLElement))throw new Error("Could not clone element");return t}function ot(e){let t=document.createElement("template");if(e=e.trim(),t.innerHTML=e,t.content.childElementCount>1)throw new Error(`Component HTML contains ${t.content.childElementCount} elements, but only 1 root element is allowed.`);let s=t.content.firstElementChild;if(!s)throw new Error("Child not found");if(!(s instanceof HTMLElement))throw new Error(`Created element is not an HTMLElement: ${e.trim()}`);return s}var fe=(e,t)=>{let s=[...t],r=ve(e),n=t.indexOf(r);return e.checked?(n===-1&&s.push(r),s):(n>-1&&s.splice(n,1),s)},ve=e=>e.dataset.value?e.dataset.value:e.value;function at(e){return e instanceof HTMLInputElement&&["text","email","password","search","tel","url"].includes(e.type)}function lt(e){return e instanceof HTMLTextAreaElement}function ct(e){return e instanceof HTMLInputElement&&["number","range"].includes(e.type)}var ht=class{constructor(){this.hooks=new Map}register(e,t){let s=this.hooks.get(e)||[];s.push(t),this.hooks.set(e,s)}unregister(e,t){let s=this.hooks.get(e)||[],r=s.indexOf(t);r!==-1&&(s.splice(r,1),this.hooks.set(e,s))}triggerHook(e,...t){(this.hooks.get(e)||[]).forEach(r=>r(...t))}},pe=(function(){"use strict";let e=new Set,t={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:w,afterNodeAdded:w,beforeNodeMorphed:w,afterNodeMorphed:w,beforeNodeRemoved:w,afterNodeRemoved:w,beforeAttributeUpdated:w},head:{style:"merge",shouldPreserve:function(i){return i.getAttribute("im-preserve")==="true"},shouldReAppend:function(i){return i.getAttribute("im-re-append")==="true"},shouldRemove:w,afterHeadMorphed:w}};function s(i,o,a={}){i instanceof Document&&(i=i.documentElement),typeof o=="string"&&(o=we(o));let f=Me(o),p=C(i,f,a);return r(i,f,p)}function r(i,o,a){if(a.head.block){let f=i.querySelector("head"),p=o.querySelector("head");if(f&&p){let m=b(p,f,a);Promise.all(m).then(function(){r(i,o,Object.assign(a,{head:{block:!1,ignore:!0}}))});return}}if(a.morphStyle==="innerHTML")return d(o,i,a),i.children;if(a.morphStyle==="outerHTML"||a.morphStyle==null){let f=ke(o,i,a),p=f?.previousSibling,m=f?.nextSibling,v=c(i,f,a);return f?Oe(p,v,m):[]}else throw"Do not understand how to morph style "+a.morphStyle}function n(i,o){return o.ignoreActiveValue&&i===document.activeElement}function c(i,o,a){if(!(a.ignoreActive&&i===document.activeElement))return o==null?a.callbacks.beforeNodeRemoved(i)===!1?i:(i.remove(),a.callbacks.afterNodeRemoved(i),null):T(i,o)?(a.callbacks.beforeNodeMorphed(i,o)===!1||(i instanceof HTMLHeadElement&&a.head.ignore||(i instanceof HTMLHeadElement&&a.head.style!=="morph"?b(o,i,a):(l(o,i,a),n(i,a)||d(o,i,a))),a.callbacks.afterNodeMorphed(i,o)),i):a.callbacks.beforeNodeRemoved(i)===!1||a.callbacks.beforeNodeAdded(o)===!1?i:(i.parentElement.replaceChild(o,i),a.callbacks.afterNodeAdded(o),a.callbacks.afterNodeRemoved(i),o)}function d(i,o,a){let f=i.firstChild,p=o.firstChild,m;for(;f;){if(m=f,f=m.nextSibling,p==null){if(a.callbacks.beforeNodeAdded(m)===!1)return;o.appendChild(m),a.callbacks.afterNodeAdded(m),S(a,m);continue}if(x(m,p,a)){c(p,m,a),p=p.nextSibling,S(a,m);continue}let v=D(i,o,m,p,a);if(v){p=j(p,v,a),c(v,m,a),S(a,m);continue}let E=Ae(i,o,m,p,a);if(E){p=j(p,E,a),c(E,m,a),S(a,m);continue}if(a.callbacks.beforeNodeAdded(m)===!1)return;o.insertBefore(m,p),a.callbacks.afterNodeAdded(m),S(a,m)}for(;p!==null;){let v=p;p=p.nextSibling,Z(v,a)}}function g(i,o,a,f){return i==="value"&&f.ignoreActiveValue&&o===document.activeElement?!0:f.callbacks.beforeAttributeUpdated(i,o,a)===!1}function l(i,o,a){let f=i.nodeType;if(f===1){let p=i.attributes,m=o.attributes;for(let v of p)g(v.name,o,"update",a)||o.getAttribute(v.name)!==v.value&&o.setAttribute(v.name,v.value);for(let v=m.length-1;0<=v;v--){let E=m[v];g(E.name,o,"remove",a)||i.hasAttribute(E.name)||o.removeAttribute(E.name)}}(f===8||f===3)&&o.nodeValue!==i.nodeValue&&(o.nodeValue=i.nodeValue),n(o,a)||u(i,o,a)}function h(i,o,a,f){if(i[a]!==o[a]){let p=g(a,o,"update",f);p||(o[a]=i[a]),i[a]?p||o.setAttribute(a,i[a]):g(a,o,"remove",f)||o.removeAttribute(a)}}function u(i,o,a){if(i instanceof HTMLInputElement&&o instanceof HTMLInputElement&&i.type!=="file"){let f=i.value,p=o.value;h(i,o,"checked",a),h(i,o,"disabled",a),i.hasAttribute("value")?f!==p&&(g("value",o,"update",a)||(o.setAttribute("value",f),o.value=f)):g("value",o,"remove",a)||(o.value="",o.removeAttribute("value"))}else if(i instanceof HTMLOptionElement)h(i,o,"selected",a);else if(i instanceof HTMLTextAreaElement&&o instanceof HTMLTextAreaElement){let f=i.value,p=o.value;if(g("value",o,"update",a))return;f!==p&&(o.value=f),o.firstChild&&o.firstChild.nodeValue!==f&&(o.firstChild.nodeValue=f)}}function b(i,o,a){let f=[],p=[],m=[],v=[],E=a.head.style,F=new Map;for(let y of i.children)F.set(y.outerHTML,y);for(let y of o.children){let M=F.has(y.outerHTML),B=a.head.shouldReAppend(y),K=a.head.shouldPreserve(y);M||K?B?p.push(y):(F.delete(y.outerHTML),m.push(y)):E==="append"?B&&(p.push(y),v.push(y)):a.head.shouldRemove(y)!==!1&&p.push(y)}v.push(...F.values());let ee=[];for(let y of v){let M=document.createRange().createContextualFragment(y.outerHTML).firstChild;if(a.callbacks.beforeNodeAdded(M)!==!1){if(M.href||M.src){let B=null,K=new Promise(function(Le){B=Le});M.addEventListener("load",function(){B()}),ee.push(K)}o.appendChild(M),a.callbacks.afterNodeAdded(M),f.push(M)}}for(let y of p)a.callbacks.beforeNodeRemoved(y)!==!1&&(o.removeChild(y),a.callbacks.afterNodeRemoved(y));return a.head.afterHeadMorphed(o,{added:f,kept:m,removed:p}),ee}function A(){}function w(){}function O(i){let o={};return Object.assign(o,t),Object.assign(o,i),o.callbacks={},Object.assign(o.callbacks,t.callbacks),Object.assign(o.callbacks,i.callbacks),o.head={},Object.assign(o.head,t.head),Object.assign(o.head,i.head),o}function C(i,o,a){return a=O(a),{target:i,newContent:o,config:a,morphStyle:a.morphStyle,ignoreActive:a.ignoreActive,ignoreActiveValue:a.ignoreActiveValue,idMap:Fe(i,o),deadIds:new Set,callbacks:a.callbacks,head:a.head}}function x(i,o,a){return i==null||o==null?!1:i.nodeType===o.nodeType&&i.tagName===o.tagName?i.id!==""&&i.id===o.id?!0:N(a,i,o)>0:!1}function T(i,o){return i==null||o==null?!1:i.nodeType===o.nodeType&&i.tagName===o.tagName}function j(i,o,a){for(;i!==o;){let f=i;i=i.nextSibling,Z(f,a)}return S(a,o),o.nextSibling}function D(i,o,a,f,p){let m=N(p,a,o),v=null;if(m>0){let E=f,F=0;for(;E!=null;){if(x(a,E,p))return E;if(F+=N(p,E,i),F>m)return null;E=E.nextSibling}}return v}function Ae(i,o,a,f,p){let m=f,v=a.nextSibling,E=0;for(;m!=null;){if(N(p,m,i)>0)return null;if(T(a,m))return m;if(T(v,m)&&(E++,v=v.nextSibling,E>=2))return null;m=m.nextSibling}return m}function we(i){let o=new DOMParser,a=i.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(a.match(/<\/html>/)||a.match(/<\/head>/)||a.match(/<\/body>/)){let f=o.parseFromString(i,"text/html");if(a.match(/<\/html>/))return f.generatedByIdiomorph=!0,f;{let p=f.firstChild;return p?(p.generatedByIdiomorph=!0,p):null}}else{let p=o.parseFromString("<body><template>"+i+"</template></body>","text/html").body.querySelector("template").content;return p.generatedByIdiomorph=!0,p}}function Me(i){if(i==null)return document.createElement("div");if(i.generatedByIdiomorph)return i;if(i instanceof Node){let o=document.createElement("div");return o.append(i),o}else{let o=document.createElement("div");for(let a of[...i])o.append(a);return o}}function Oe(i,o,a){let f=[],p=[];for(;i!=null;)f.push(i),i=i.previousSibling;for(;f.length>0;){let m=f.pop();p.push(m),o.parentElement.insertBefore(m,o)}for(p.push(o);a!=null;)f.push(a),p.push(a),a=a.nextSibling;for(;f.length>0;)o.parentElement.insertBefore(f.pop(),o.nextSibling);return p}function ke(i,o,a){let f;f=i.firstChild;let p=f,m=0;for(;f;){let v=Ce(f,o,a);v>m&&(p=f,m=v),f=f.nextSibling}return p}function Ce(i,o,a){return T(i,o)?.5+N(a,i,o):0}function Z(i,o){S(o,i),o.callbacks.beforeNodeRemoved(i)!==!1&&(i.remove(),o.callbacks.afterNodeRemoved(i))}function Te(i,o){return!i.deadIds.has(o)}function Se(i,o,a){return(i.idMap.get(a)||e).has(o)}function S(i,o){let a=i.idMap.get(o)||e;for(let f of a)i.deadIds.add(f)}function N(i,o,a){let f=i.idMap.get(o)||e,p=0;for(let m of f)Te(i,m)&&Se(i,m,a)&&++p;return p}function Q(i,o){let a=i.parentElement,f=i.querySelectorAll("[id]");for(let p of f){let m=p;for(;m!==a&&m!=null;){let v=o.get(m);v==null&&(v=new Set,o.set(m,v)),v.add(p.id),m=m.parentElement}}}function Fe(i,o){let a=new Map;return Q(i,a),Q(o,a),a}return{morph:s,defaults:t}})();function J(e){e instanceof HTMLInputElement&&e.type==="file"||("value"in e?e.setAttribute("value",e.value):e.hasAttribute("value")&&e.setAttribute("value","")),Array.from(e.children).forEach(s=>{J(s)})}var ut=(e,t)=>{for(let s=0;s<e.attributes.length;s++){let r=e.attributes[s];t.setAttribute(r.name,r.value)}};function dt(e,t,s,r,n){let c=[],d=new Map,g=(l,h)=>{let u=d.get(l);if(!(u instanceof HTMLElement))throw new Error(`Original element with id ${l} not found`);if(c.push(l),!h)return null;let b=z(u);return u.replaceWith(b),b};t.querySelectorAll("[data-live-preserve]").forEach(l=>{let h=l.id;if(!h)throw new Error("The data-live-preserve attribute requires an id attribute to be set on the element");let u=e.querySelector(`#${h}`);if(!(u instanceof HTMLElement))throw new Error(`The element with id "${h}" was not found in the original HTML`);l.removeAttribute("data-live-preserve"),d.set(h,u),ut(l,u)}),pe.morph(e,t,{callbacks:{beforeNodeMorphed:(l,h)=>{if(!(l instanceof Element)||!(h instanceof Element)||l===e)return!0;if(l.id&&d.has(l.id)){if(l.id===h.id)return!1;let u=g(l.id,!0);if(!u)throw new Error("missing clone");return pe.morph(u,h),!1}if(l instanceof HTMLElement&&h instanceof HTMLElement){if(typeof l.__x<"u"){if(!window.Alpine)throw new Error("Unable to access Alpine.js though the global window.Alpine variable. Please make sure Alpine.js is loaded before Symfony UX LiveComponent.");if(typeof window.Alpine.morph!="function")throw new Error("Unable to access Alpine.js morph function. Please make sure the Alpine.js Morph plugin is installed and loaded, see https://alpinejs.dev/plugins/morph for more information.");window.Alpine.morph(l.__x,h)}if(n.wasElementAdded(l))return l.insertAdjacentElement("afterend",h),!1;s.includes(l)&&W(h,r(l)),l===document.activeElement&&l!==document.body&&P(l,!1)!==null&&W(h,r(l));let u=n.getChangedElement(l);if(u&&u.applyToElement(h),l.nodeName.toUpperCase()!=="OPTION"&&l.isEqualNode(h)){let b=z(l);J(b);let A=z(h);if(J(A),b.isEqualNode(A))return!1}}return l.hasAttribute("data-skip-morph")||l.id&&l.id!==h.id?(l.innerHTML=h.innerHTML,!0):l.parentElement?.hasAttribute("data-skip-morph")?!1:!l.hasAttribute("data-live-ignore")},beforeNodeRemoved(l){return l instanceof HTMLElement?l.id&&d.has(l.id)?(g(l.id,!1),!0):n.wasElementAdded(l)?!1:!l.hasAttribute("data-live-ignore"):!0}}}),c.forEach(l=>{let h=e.querySelector(`#${l}`),u=d.get(l);if(!(h instanceof HTMLElement)||!(u instanceof HTMLElement))throw new Error("Missing elements.");h.replaceWith(u)})}var ge=class{constructor(){this.changedItems=new Map,this.removedItems=new Map}setItem(e,t,s){if(this.removedItems.has(e)){let r=this.removedItems.get(e);if(this.removedItems.delete(e),r.original===t)return}if(this.changedItems.has(e)){let r=this.changedItems.get(e);if(r.original===t){this.changedItems.delete(e);return}this.changedItems.set(e,{original:r.original,new:t});return}this.changedItems.set(e,{original:s,new:t})}removeItem(e,t){let s=t;this.changedItems.has(e)&&(s=this.changedItems.get(e).original,this.changedItems.delete(e),s===null)||this.removedItems.has(e)||this.removedItems.set(e,{original:s})}getChangedItems(){return Array.from(this.changedItems,([e,{new:t}])=>({name:e,value:t}))}getRemovedItems(){return Array.from(this.removedItems.keys())}isEmpty(){return this.changedItems.size===0&&this.removedItems.size===0}},ft=class{constructor(){this.addedClasses=new Set,this.removedClasses=new Set,this.styleChanges=new ge,this.attributeChanges=new ge}addClass(e){this.removedClasses.delete(e)||this.addedClasses.add(e)}removeClass(e){this.addedClasses.delete(e)||this.removedClasses.add(e)}addStyle(e,t,s){this.styleChanges.setItem(e,t,s)}removeStyle(e,t){this.styleChanges.removeItem(e,t)}addAttribute(e,t,s){this.attributeChanges.setItem(e,t,s)}removeAttribute(e,t){this.attributeChanges.removeItem(e,t)}getAddedClasses(){return[...this.addedClasses]}getRemovedClasses(){return[...this.removedClasses]}getChangedStyles(){return this.styleChanges.getChangedItems()}getRemovedStyles(){return this.styleChanges.getRemovedItems()}getChangedAttributes(){return this.attributeChanges.getChangedItems()}getRemovedAttributes(){return this.attributeChanges.getRemovedItems()}applyToElement(e){e.classList.add(...this.addedClasses),e.classList.remove(...this.removedClasses),this.styleChanges.getChangedItems().forEach(t=>{e.style.setProperty(t.name,t.value)}),this.styleChanges.getRemovedItems().forEach(t=>{e.style.removeProperty(t)}),this.attributeChanges.getChangedItems().forEach(t=>{e.setAttribute(t.name,t.value)}),this.attributeChanges.getRemovedItems().forEach(t=>{e.removeAttribute(t)})}isEmpty(){return this.addedClasses.size===0&&this.removedClasses.size===0&&this.styleChanges.isEmpty()&&this.attributeChanges.isEmpty()}},pt=class{constructor(e,t){this.changedElements=new WeakMap,this.changedElementsCount=0,this.addedElements=[],this.removedElements=[],this.isStarted=!1,this.element=e,this.shouldTrackChangeCallback=t,this.mutationObserver=new MutationObserver(this.onMutations.bind(this))}start(){this.isStarted||(this.mutationObserver.observe(this.element,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0}),this.isStarted=!0)}stop(){this.isStarted&&(this.mutationObserver.disconnect(),this.isStarted=!1)}getChangedElement(e){return this.changedElements.has(e)?this.changedElements.get(e):null}getAddedElements(){return this.addedElements}wasElementAdded(e){return this.addedElements.includes(e)}handlePendingChanges(){this.onMutations(this.mutationObserver.takeRecords())}onMutations(e){let t=new WeakMap;for(let s of e){let r=s.target;if(!this.shouldTrackChangeCallback(r)||this.isElementAddedByTranslation(r))continue;let n=!1;for(let c of this.addedElements)if(c.contains(r)){n=!0;break}if(!n)switch(s.type){case"childList":this.handleChildListMutation(s);break;case"attributes":t.has(r)||t.set(r,[]),t.get(r).includes(s.attributeName)||(this.handleAttributeMutation(s),t.set(r,[...t.get(r),s.attributeName]));break}}}handleChildListMutation(e){e.addedNodes.forEach(t=>{if(t instanceof Element){if(this.removedElements.includes(t)){this.removedElements.splice(this.removedElements.indexOf(t),1);return}this.isElementAddedByTranslation(t)||this.addedElements.push(t)}}),e.removedNodes.forEach(t=>{if(t instanceof Element){if(this.addedElements.includes(t)){this.addedElements.splice(this.addedElements.indexOf(t),1);return}this.removedElements.push(t)}})}handleAttributeMutation(e){let t=e.target;this.changedElements.has(t)||(this.changedElements.set(t,new ft),this.changedElementsCount++);let s=this.changedElements.get(t);switch(e.attributeName){case"class":this.handleClassAttributeMutation(e,s);break;case"style":this.handleStyleAttributeMutation(e,s);break;default:this.handleGenericAttributeMutation(e,s)}s.isEmpty()&&(this.changedElements.delete(t),this.changedElementsCount--)}handleClassAttributeMutation(e,t){let s=e.target,n=(e.oldValue||"").match(/(\S+)/gu)||[],c=[].slice.call(s.classList),d=c.filter(l=>!n.includes(l)),g=n.filter(l=>!c.includes(l));d.forEach(l=>{t.addClass(l)}),g.forEach(l=>{t.removeClass(l)})}handleStyleAttributeMutation(e,t){let s=e.target,r=e.oldValue||"",n=this.extractStyles(r),c=s.getAttribute("style")||"",d=this.extractStyles(c),g=Object.keys(d).filter(h=>n[h]===void 0||n[h]!==d[h]),l=Object.keys(n).filter(h=>!d[h]);g.forEach(h=>{t.addStyle(h,d[h],n[h]===void 0?null:n[h])}),l.forEach(h=>{t.removeStyle(h,n[h])})}handleGenericAttributeMutation(e,t){let s=e.attributeName,r=e.target,n=e.oldValue,c=r.getAttribute(s);if(n===s&&(n=""),c===s&&(c=""),!r.hasAttribute(s)){if(n===null)return;t.removeAttribute(s,e.oldValue);return}c!==n&&t.addAttribute(s,r.getAttribute(s),e.oldValue)}extractStyles(e){let t={};return e.split(";").forEach(s=>{let r=s.split(":");if(r.length===1)return;let n=r[0].trim();t[n]=r.slice(1).join(":").trim()}),t}isElementAddedByTranslation(e){return e.tagName==="FONT"&&e.getAttribute("style")==="vertical-align: inherit;"}},gt=class{constructor(e,t){this.elementEventListeners=[{event:"input",callback:s=>this.handleInputEvent(s)}],this.component=e,this.modelElementResolver=t,this.unsyncedInputs=new mt}activate(){this.elementEventListeners.forEach(({event:e,callback:t})=>{this.component.element.addEventListener(e,t)})}deactivate(){this.elementEventListeners.forEach(({event:e,callback:t})=>{this.component.element.removeEventListener(e,t)})}markModelAsSynced(e){this.unsyncedInputs.markModelAsSynced(e)}handleInputEvent(e){let t=e.target;t&&this.updateModelFromElement(t)}updateModelFromElement(e){if(!R(e,this.component))return;if(!(e instanceof HTMLElement))throw new Error("Could not update model for non HTMLElement");let t=this.modelElementResolver.getModelName(e);this.unsyncedInputs.add(e,t)}getUnsyncedInputs(){return this.unsyncedInputs.allUnsyncedInputs()}getUnsyncedModels(){return Array.from(this.unsyncedInputs.getUnsyncedModelNames())}resetUnsyncedFields(){this.unsyncedInputs.resetUnsyncedFields()}},mt=class{constructor(){this.unsyncedNonModelFields=[],this.unsyncedModelNames=[],this.unsyncedModelFields=new Map}add(e,t=null){if(t){this.unsyncedModelFields.set(t,e),this.unsyncedModelNames.includes(t)||this.unsyncedModelNames.push(t);return}this.unsyncedNonModelFields.push(e)}resetUnsyncedFields(){this.unsyncedModelFields.forEach((e,t)=>{this.unsyncedModelNames.includes(t)||this.unsyncedModelFields.delete(t)})}allUnsyncedInputs(){return[...this.unsyncedNonModelFields,...this.unsyncedModelFields.values()]}markModelAsSynced(e){let t=this.unsyncedModelNames.indexOf(e);t!==-1&&this.unsyncedModelNames.splice(t,1)}getUnsyncedModelNames(){return this.unsyncedModelNames}};function vt(e,t){let{currentLevelData:s,finalKey:r}=bt(e,t);if(s!==void 0)return s[r]}var bt=(e,t)=>{let s=JSON.parse(JSON.stringify(e)),r=s,n=t.split(".");for(let d=0;d<n.length-1;d++)r=r[n[d]];let c=n[n.length-1];return{currentLevelData:r,finalData:s,finalKey:c,parts:n}},yt=class{constructor(e){this.props={},this.dirtyProps={},this.pendingProps={},this.updatedPropsFromParent={},this.props=e}get(e){let t=I(e);return this.dirtyProps[t]!==void 0?this.dirtyProps[t]:this.pendingProps[t]!==void 0?this.pendingProps[t]:this.props[t]!==void 0?this.props[t]:vt(this.props,t)}has(e){return this.get(e)!==void 0}set(e,t){let s=I(e);return this.get(s)===t?!1:(this.dirtyProps[s]=t,!0)}getOriginalProps(){return{...this.props}}getDirtyProps(){return{...this.dirtyProps}}getUpdatedPropsFromParent(){return{...this.updatedPropsFromParent}}flushDirtyPropsToPending(){this.pendingProps={...this.dirtyProps},this.dirtyProps={}}reinitializeAllProps(e){this.props=e,this.updatedPropsFromParent={},this.pendingProps={}}pushPendingPropsBackToDirty(){this.dirtyProps={...this.pendingProps,...this.dirtyProps},this.pendingProps={}}storeNewPropsFromParent(e){let t=!1;for(let[s,r]of Object.entries(e))this.get(s)!==r&&(t=!0);return t&&(this.updatedPropsFromParent=e),t}},Et=class{constructor(e,t,s,r,n,c,d){this.fingerprint="",this.defaultDebounce=150,this.backendRequest=null,this.pendingActions=[],this.pendingFiles={},this.isRequestPending=!1,this.requestDebounceTimeout=null,this.element=e,this.name=t,this.backend=c,this.elementDriver=d,this.id=n,this.listeners=new Map,r.forEach(g=>{this.listeners.has(g.event)||this.listeners.set(g.event,[]),this.listeners.get(g.event)?.push(g.action)}),this.valueStore=new yt(s),this.unsyncedInputsTracker=new gt(this,d),this.hooks=new ht,this.resetPromise(),this.externalMutationTracker=new pt(this.element,g=>R(g,this)),this.externalMutationTracker.start()}addPlugin(e){e.attachToComponent(this)}connect(){et(this),this.hooks.triggerHook("connect",this),this.unsyncedInputsTracker.activate(),this.externalMutationTracker.start()}disconnect(){tt(this),this.hooks.triggerHook("disconnect",this),this.clearRequestDebounceTimeout(),this.unsyncedInputsTracker.deactivate(),this.externalMutationTracker.stop()}on(e,t){this.hooks.register(e,t)}off(e,t){this.hooks.unregister(e,t)}set(e,t,s=!1,r=!1){let n=this.nextRequestPromise,c=I(e);if(!this.valueStore.has(c))throw new Error(`Invalid model name "${e}".`);let d=this.valueStore.set(c,t);return this.hooks.triggerHook("model:set",e,t,this),this.unsyncedInputsTracker.markModelAsSynced(c),s&&d&&this.debouncedStartRequest(r),n}getData(e){let t=I(e);if(!this.valueStore.has(t))throw new Error(`Invalid model "${e}".`);return this.valueStore.get(t)}action(e,t={},s=!1){let r=this.nextRequestPromise;return this.pendingActions.push({name:e,args:t}),this.debouncedStartRequest(s),r}files(e,t){this.pendingFiles[e]=t}render(){let e=this.nextRequestPromise;return this.tryStartingRequest(),e}getUnsyncedModels(){return this.unsyncedInputsTracker.getUnsyncedModels()}emit(e,t,s=null){this.performEmit(e,t,!1,s)}emitUp(e,t,s=null){this.performEmit(e,t,!0,s)}emitSelf(e,t){this.doEmit(e,t)}performEmit(e,t,s,r){st(this,s,r).forEach(c=>{c.doEmit(e,t)})}doEmit(e,t){if(!this.listeners.has(e))return;(this.listeners.get(e)||[]).forEach(r=>{this.action(r,t,1)})}isTurboEnabled(){return typeof Turbo<"u"&&!this.element.closest('[data-turbo="false"]')}tryStartingRequest(){if(!this.backendRequest){this.performRequest();return}this.isRequestPending=!0}performRequest(){let e=this.nextRequestPromiseResolve;this.resetPromise(),this.unsyncedInputsTracker.resetUnsyncedFields();let t={};for(let[r,n]of Object.entries(this.pendingFiles))n.files&&(t[r]=n.files);let s={props:this.valueStore.getOriginalProps(),actions:this.pendingActions,updated:this.valueStore.getDirtyProps(),children:{},updatedPropsFromParent:this.valueStore.getUpdatedPropsFromParent(),files:t};this.hooks.triggerHook("request:started",s),this.backendRequest=this.backend.makeRequest(s.props,s.actions,s.updated,s.children,s.updatedPropsFromParent,s.files),this.hooks.triggerHook("loading.state:started",this.element,this.backendRequest),this.pendingActions=[],this.valueStore.flushDirtyPropsToPending(),this.isRequestPending=!1,this.backendRequest.promise.then(async r=>{let n=new Qe(r),c=await n.getBody();for(let l of Object.values(this.pendingFiles))l.value="";let d=n.response.headers;if(!d.get("Content-Type")?.includes("application/vnd.live-component+html")&&!d.get("X-Live-Redirect")){let l={displayError:!0};return this.valueStore.pushPendingPropsBackToDirty(),this.hooks.triggerHook("response:error",n,l),l.displayError&&this.renderError(c),this.backendRequest=null,e(n),r}let g=n.getLiveUrl();return g&&history.replaceState(history.state,"",new URL(g+window.location.hash,window.location.origin)),this.processRerender(c,n),this.backendRequest=null,e(n),this.isRequestPending&&(this.isRequestPending=!1,this.performRequest()),r})}processRerender(e,t){let s={shouldRender:!0};if(this.hooks.triggerHook("render:started",e,t,s),!s.shouldRender)return;if(t.response.headers.get("Location")){this.isTurboEnabled()?Turbo.visit(t.response.headers.get("Location")):window.location.href=t.response.headers.get("Location")||"";return}this.hooks.triggerHook("loading.state:finished",this.element);let r={};Object.keys(this.valueStore.getDirtyProps()).forEach(l=>{r[l]=this.valueStore.get(l)});let n;try{if(n=ot(e),!n.matches("[data-controller~=live]"))throw new Error("A live component template must contain a single root controller element.")}catch(l){throw console.error(`There was a problem with the '${this.name}' component HTML returned:`,{id:this.id}),l}this.externalMutationTracker.handlePendingChanges(),this.externalMutationTracker.stop(),dt(this.element,n,this.unsyncedInputsTracker.getUnsyncedInputs(),l=>G(l,this.valueStore),this.externalMutationTracker),this.externalMutationTracker.start();let c=this.elementDriver.getComponentProps();this.valueStore.reinitializeAllProps(c);let d=this.elementDriver.getEventsToEmit(),g=this.elementDriver.getBrowserEventsToDispatch();Object.keys(r).forEach(l=>{this.valueStore.set(l,r[l])}),d.forEach(({event:l,data:h,target:u,componentName:b})=>{if(u==="up"){this.emitUp(l,h,b);return}if(u==="self"){this.emitSelf(l,h);return}this.emit(l,h,b)}),g.forEach(({event:l,payload:h})=>{this.element.dispatchEvent(new CustomEvent(l,{detail:h,bubbles:!0}))}),this.hooks.triggerHook("render:finished",this)}calculateDebounce(e){return e===!0?this.defaultDebounce:e===!1?0:e}clearRequestDebounceTimeout(){this.requestDebounceTimeout&&(clearTimeout(this.requestDebounceTimeout),this.requestDebounceTimeout=null)}debouncedStartRequest(e){this.clearRequestDebounceTimeout(),this.requestDebounceTimeout=window.setTimeout(()=>{this.render()},this.calculateDebounce(e))}renderError(e){let t=document.getElementById("live-component-error");t?t.innerHTML="":(t=document.createElement("div"),t.id="live-component-error",t.style.padding="50px",t.style.backgroundColor="rgba(0, 0, 0, .5)",t.style.zIndex="100000",t.style.position="fixed",t.style.top="0px",t.style.bottom="0px",t.style.left="0px",t.style.right="0px",t.style.display="flex",t.style.flexDirection="column");let s=document.createElement("iframe");s.style.borderRadius="5px",s.style.flexGrow="1",t.appendChild(s),document.body.prepend(t),document.body.style.overflow="hidden",s.contentWindow&&(s.contentWindow.document.open(),s.contentWindow.document.write(e),s.contentWindow.document.close());let r=n=>{n&&(n.outerHTML=""),document.body.style.overflow="visible"};t.addEventListener("click",()=>r(t)),t.setAttribute("tabindex","0"),t.addEventListener("keydown",n=>{n.key==="Escape"&&r(t)}),t.focus()}resetPromise(){this.nextRequestPromise=new Promise(e=>{this.nextRequestPromiseResolve=e})}_updateFromParentProps(e){this.valueStore.storeNewPropsFromParent(e)&&this.render()}};function At(e){return new Proxy(e,{get(t,s){if(s in t||typeof s!="string"){if(typeof t[s]=="function"){let r=t[s];return(...n)=>r.apply(t,n)}return Reflect.get(t,s)}return t.valueStore.has(s)?t.getData(s):r=>t.action.apply(t,[s,r])},set(t,s,r){return s in t?(t[s]=r,!0):(t.set(s,r),!0)}})}var wt=class{constructor(e){this.controller=e}getModelName(e){let t=P(e,!1);return t?t.action:null}getComponentProps(){return this.controller.propsValue}getEventsToEmit(){return this.controller.eventsToEmitValue}getBrowserEventsToDispatch(){return this.controller.eventsToDispatchValue}};function be(e){let t=!0,s=null,r=!1,n=null,c=null,d=null,g=null;e.modifiers.forEach(u=>{switch(u.name){case"on":if(!u.value)throw new Error(`The "on" modifier in ${e.getString()} requires a value - e.g. on(change).`);if(!["input","change"].includes(u.value))throw new Error(`The "on" modifier in ${e.getString()} only accepts the arguments "input" or "change".`);s=u.value;break;case"norender":t=!1;break;case"debounce":r=u.value?Number.parseInt(u.value):!0;break;case"min_length":n=u.value?Number.parseInt(u.value):null;break;case"max_length":c=u.value?Number.parseInt(u.value):null;break;case"min_value":d=u.value?Number.parseFloat(u.value):null;break;case"max_value":g=u.value?Number.parseFloat(u.value):null;break;default:throw new Error(`Unknown modifier "${u.name}" in data-model="${e.getString()}".`)}});let[l,h]=e.action.split(":");return{modelName:l,innerModelName:h||null,shouldRender:t,debounce:r,targetEventName:s,minLength:n,maxLength:c,minValue:d,maxValue:g}}var Mt=class{constructor(e){this.parentModelBindings=[],this.component=e;let t=me(this.component.element);this.parentModelBindings=t.map(be)}attachToComponent(e){e.on("request:started",t=>{t.children=this.getChildrenFingerprints()}),e.on("model:set",(t,s)=>{this.notifyParentModelChange(t,s)})}getChildrenFingerprints(){let e={};return this.getChildren().forEach(t=>{if(!t.id)throw new Error("missing id");e[t.id]={fingerprint:t.fingerprint,tag:t.element.tagName.toLowerCase()}}),e}notifyParentModelChange(e,t){let s=nt(this.component);s&&this.parentModelBindings.forEach(r=>{(r.innerModelName||"value")===e&&s.set(r.modelName,t,r.shouldRender,r.debounce)})}getChildren(){return rt(this.component)}},Ot=class{constructor(){this.intersectionObserver=null}attachToComponent(e){e.element.attributes.getNamedItem("loading")?.value==="lazy"&&(e.on("connect",()=>{this.getObserver().observe(e.element)}),e.on("disconnect",()=>{this.intersectionObserver?.unobserve(e.element)}))}getObserver(){return this.intersectionObserver||(this.intersectionObserver=new IntersectionObserver((e,t)=>{e.forEach(s=>{s.isIntersecting&&(s.target.dispatchEvent(new CustomEvent("live:appear")),t.unobserve(s.target))})})),this.intersectionObserver}},kt=class{attachToComponent(e){e.on("loading.state:started",(t,s)=>{this.startLoading(e,t,s)}),e.on("loading.state:finished",t=>{this.finishLoading(e,t)}),this.finishLoading(e,e.element)}startLoading(e,t,s){this.handleLoadingToggle(e,!0,t,s)}finishLoading(e,t){this.handleLoadingToggle(e,!1,t,null)}handleLoadingToggle(e,t,s,r){t?this.addAttributes(s,["busy"]):this.removeAttributes(s,["busy"]),this.getLoadingDirectives(e,s).forEach(({element:n,directives:c})=>{t?this.addAttributes(n,["data-live-is-loading"]):this.removeAttributes(n,["data-live-is-loading"]),c.forEach(d=>{this.handleLoadingDirective(n,t,d,r)})})}handleLoadingDirective(e,t,s,r){let n=Ct(s.action,t),c=[],d=[],g=0,l=new Map;if(l.set("delay",u=>{t&&(g=u.value?Number.parseInt(u.value):200)}),l.set("action",u=>{if(!u.value)throw new Error(`The "action" in data-loading must have an action name - e.g. action(foo). It's missing for "${s.getString()}"`);c.push(u.value)}),l.set("model",u=>{if(!u.value)throw new Error(`The "model" in data-loading must have an action name - e.g. model(foo). It's missing for "${s.getString()}"`);d.push(u.value)}),s.modifiers.forEach(u=>{if(l.has(u.name)){(l.get(u.name)??(()=>{}))(u);return}throw new Error(`Unknown modifier "${u.name}" used in data-loading="${s.getString()}". Available modifiers are: ${Array.from(l.keys()).join(", ")}.`)}),t&&c.length>0&&r&&!r.containsOneOfActions(c)||t&&d.length>0&&r&&!r.areAnyModelsUpdated(d))return;let h;switch(n){case"show":h=()=>this.showElement(e);break;case"hide":h=()=>this.hideElement(e);break;case"addClass":h=()=>this.addClass(e,s.args);break;case"removeClass":h=()=>this.removeClass(e,s.args);break;case"addAttribute":h=()=>this.addAttributes(e,s.args);break;case"removeAttribute":h=()=>this.removeAttributes(e,s.args);break;default:throw new Error(`Unknown data-loading action "${n}"`)}if(g){window.setTimeout(()=>{r&&!r.isResolved&&h()},g);return}h()}getLoadingDirectives(e,t){let s=[],r=[...Array.from(t.querySelectorAll("[data-loading]"))];return r=r.filter(n=>R(n,e)),t.hasAttribute("data-loading")&&(r=[t,...r]),r.forEach(n=>{if(!(n instanceof HTMLElement)&&!(n instanceof SVGElement))throw new Error("Invalid Element Type");let c=L(n.dataset.loading||"show");s.push({element:n,directives:c})}),s}showElement(e){e.style.display="revert"}hideElement(e){e.style.display="none"}addClass(e,t){e.classList.add(...de(t))}removeClass(e,t){e.classList.remove(...de(t)),e.classList.length===0&&e.removeAttribute("class")}addAttributes(e,t){t.forEach(s=>{e.setAttribute(s,"")})}removeAttributes(e,t){t.forEach(s=>{e.removeAttribute(s)})}},Ct=(e,t)=>{switch(e){case"show":return t?"show":"hide";case"hide":return t?"hide":"show";case"addClass":return t?"addClass":"removeClass";case"removeClass":return t?"removeClass":"addClass";case"addAttribute":return t?"addAttribute":"removeAttribute";case"removeAttribute":return t?"removeAttribute":"addAttribute"}throw new Error(`Unknown data-loading action "${e}"`)},Tt=class{constructor(){this.isConnected=!1}attachToComponent(e){e.on("render:started",(t,s,r)=>{this.isConnected||(r.shouldRender=!1)}),e.on("connect",()=>{this.isConnected=!0}),e.on("disconnect",()=>{this.isConnected=!1})}},St=class{constructor(e){this.isPollingActive=!0,this.pollingIntervals=[],this.component=e}addPoll(e,t){this.polls.push({actionName:e,duration:t}),this.isPollingActive&&this.initiatePoll(e,t)}startAllPolling(){this.isPollingActive||(this.isPollingActive=!0,this.polls.forEach(({actionName:e,duration:t})=>{this.initiatePoll(e,t)}))}stopAllPolling(){this.isPollingActive=!1,this.pollingIntervals.forEach(e=>{clearInterval(e)})}clearPolling(){this.stopAllPolling(),this.polls=[],this.startAllPolling()}initiatePoll(e,t){let s;e==="$render"?s=()=>{this.component.render()}:s=()=>{this.component.action(e,{},0)};let r=window.setInterval(()=>{s()},t);this.pollingIntervals.push(r)}},Ft=class{attachToComponent(e){this.element=e.element,this.pollingDirector=new St(e),this.initializePolling(),e.on("connect",()=>{this.pollingDirector.startAllPolling()}),e.on("disconnect",()=>{this.pollingDirector.stopAllPolling()}),e.on("render:finished",()=>{this.initializePolling()})}addPoll(e,t){this.pollingDirector.addPoll(e,t)}clearPolling(){this.pollingDirector.clearPolling()}initializePolling(){if(this.clearPolling(),this.element.dataset.poll===void 0)return;let e=this.element.dataset.poll;L(e||"$render").forEach(s=>{let r=2e3;s.modifiers.forEach(n=>{switch(n.name){case"delay":n.value&&(r=Number.parseInt(n.value));break;default:console.warn(`Unknown modifier "${n.name}" in data-poll "${e}".`)}}),this.addPoll(s.action,r)})}},Lt=class{attachToComponent(e){this.synchronizeValueOfModelFields(e),e.on("render:finished",()=>{this.synchronizeValueOfModelFields(e)})}synchronizeValueOfModelFields(e){e.element.querySelectorAll("[data-model]").forEach(t=>{if(!(t instanceof HTMLElement))throw new Error("Invalid element using data-model.");if(t instanceof HTMLFormElement||!R(t,e))return;let s=P(t);if(!s)return;let r=s.action;e.getUnsyncedModels().includes(r)||(e.valueStore.has(r)&&W(t,e.valueStore.get(r)),t instanceof HTMLSelectElement&&!t.multiple&&e.valueStore.set(r,G(t,e.valueStore)))})}},It=class{attachToComponent(e){e.on("model:set",t=>{this.handleModelSet(t,e.valueStore)})}handleModelSet(e,t){if(t.has("validatedFields")){let s=[...t.get("validatedFields")];s.includes(e)||s.push(e),t.set("validatedFields",s)}}},Y=class ye extends k{constructor(){super(...arguments),this.pendingActionTriggerModelElement=null,this.elementEventListeners=[{event:"input",callback:t=>this.handleInputEvent(t)},{event:"change",callback:t=>this.handleChangeEvent(t)}],this.pendingFiles={}}initialize(){this.mutationObserver=new MutationObserver(this.onMutations.bind(this)),this.createComponent()}connect(){this.connectComponent(),this.mutationObserver.observe(this.element,{attributes:!0})}disconnect(){this.disconnectComponent(),this.mutationObserver.disconnect()}update(t){if(t.type==="input"||t.type==="change")throw new Error(`Since LiveComponents 2.3, you no longer need data-action="live#update" on form elements. Found on element: ${q(t.currentTarget)}`);this.updateModelFromElementEvent(t.currentTarget,null)}action(t){let s=t.params;if(!s.action)throw new Error(`No action name provided on element: ${q(t.currentTarget)}. Did you forget to add the "data-live-action-param" attribute?`);let r=s.action,n={...s};delete n.action;let c=L(r),d=!1;c.forEach(g=>{let l={},h=new Map;h.set("stop",()=>{t.stopPropagation()}),h.set("self",()=>{t.target,t.currentTarget}),h.set("debounce",u=>{d=u.value?Number.parseInt(u.value):!0}),h.set("files",u=>{u.value?this.pendingFiles[u.value]&&(l[u.value]=this.pendingFiles[u.value]):l=this.pendingFiles}),g.modifiers.forEach(u=>{if(h.has(u.name)){(h.get(u.name)??(()=>{}))(u);return}console.warn(`Unknown modifier ${u.name} in action "${r}". Available modifiers are: ${Array.from(h.keys()).join(", ")}.`)});for(let[u,b]of Object.entries(l))b.files&&this.component.files(u,b),delete this.pendingFiles[u];this.component.action(g.action,n,d),P(t.currentTarget,!1)&&(this.pendingActionTriggerModelElement=t.currentTarget)})}$render(){return this.component.render()}emit(t){this.getEmitDirectives(t).forEach(({name:s,data:r,nameMatch:n})=>{this.component.emit(s,r,n)})}emitUp(t){this.getEmitDirectives(t).forEach(({name:s,data:r,nameMatch:n})=>{this.component.emitUp(s,r,n)})}emitSelf(t){this.getEmitDirectives(t).forEach(({name:s,data:r})=>{this.component.emitSelf(s,r)})}$updateModel(t,s,r=!0,n=!0){return this.component.set(t,s,r,n)}propsUpdatedFromParentValueChanged(){this.component._updateFromParentProps(this.propsUpdatedFromParentValue)}fingerprintValueChanged(){this.component.fingerprint=this.fingerprintValue}getEmitDirectives(t){let s=t.params;if(!s.event)throw new Error(`No event name provided on element: ${q(t.currentTarget)}. Did you forget to add the "data-live-event-param" attribute?`);let r=s.event,n={...s};delete n.event;let c=L(r),d=[];return c.forEach(g=>{let l=null;g.modifiers.forEach(h=>{switch(h.name){case"name":l=h.value;break;default:throw new Error(`Unknown modifier ${h.name} in event "${r}".`)}}),d.push({name:g.action,data:n,nameMatch:l})}),d}createComponent(){let t=this.element.id||null;this.component=new Et(this.element,this.nameValue,this.propsValue,this.listenersValue,t,ye.backendFactory(this),new wt(this)),this.proxiedComponent=At(this.component),Object.defineProperty(this.element,"__component",{value:this.proxiedComponent,writable:!0}),this.hasDebounceValue&&(this.component.defaultDebounce=this.debounceValue),[new kt,new Ot,new It,new Tt,new Ft,new Lt,new Mt(this.component)].forEach(r=>{this.component.addPlugin(r)})}connectComponent(){this.component.connect(),this.mutationObserver.observe(this.element,{attributes:!0}),this.elementEventListeners.forEach(({event:t,callback:s})=>{this.component.element.addEventListener(t,s)}),this.dispatchEvent("connect")}disconnectComponent(){this.component.disconnect(),this.elementEventListeners.forEach(({event:t,callback:s})=>{this.component.element.removeEventListener(t,s)}),this.dispatchEvent("disconnect")}handleInputEvent(t){let s=t.target;s&&this.updateModelFromElementEvent(s,"input")}handleChangeEvent(t){let s=t.target;s&&this.updateModelFromElementEvent(s,"change")}updateModelFromElementEvent(t,s){if(!R(t,this.component))return;if(!(t instanceof HTMLElement))throw new Error("Could not update model for non HTMLElement");if(t instanceof HTMLInputElement&&t.type==="file"){let d=t.name;t.files?.length?this.pendingFiles[d]=t:this.pendingFiles[d]&&delete this.pendingFiles[d]}let r=P(t,!1);if(!r)return;let n=be(r);if(n.targetEventName||(n.targetEventName="input"),this.pendingActionTriggerModelElement===t&&(n.shouldRender=!1),s==="change"&&n.targetEventName==="input"&&(n.targetEventName="change"),s&&n.targetEventName!==s)return;n.debounce===!1&&(n.targetEventName==="input"?n.debounce=!0:n.debounce=0);let c=G(t,this.component.valueStore);if(!((at(t)||lt(t))&&(n.minLength!==null&&typeof c=="string"&&c.length<n.minLength||n.maxLength!==null&&typeof c=="string"&&c.length>n.maxLength))){if(ct(t)){let d=Number(c);if(n.minValue!==null&&d<n.minValue||n.maxValue!==null&&d>n.maxValue)return}this.component.set(n.modelName,c,n.shouldRender,n.debounce)}}dispatchEvent(t,s={},r=!0,n=!1){s.controller=this,s.component=this.proxiedComponent,this.dispatch(t,{detail:s,prefix:"live",cancelable:n,bubbles:r})}onMutations(t){t.forEach(s=>{s.type==="attributes"&&s.attributeName==="id"&&this.element.id!==this.component.id&&(this.disconnectComponent(),this.createComponent(),this.connectComponent())})}};Y.values={name:String,url:String,props:{type:Object,default:{}},propsUpdatedFromParent:{type:Object,default:{}},listeners:{type:Array,default:[]},eventsToEmit:{type:Array,default:[]},eventsToDispatch:{type:Array,default:[]},debounce:{type:Number,default:150},fingerprint:{type:String,default:""},requestMethod:{type:String,default:"post"}};Y.backendFactory=e=>new Ze(e.urlValue,e.requestMethodValue);var Ee=Y;window.LiveController=Ee;})();
